{% extends "base.html" %}
{% block title %}Prog1Box{% endblock %}
{% block css %}"./css/dashboard.css"{% endblock %}
{% block bodyparameters %}style="position:relative" data-spy="scroll" data-target=".navbar-example"{% endblock %}
{% block navbar %}
<li class="active"><a href="#">Home</a></li>
{% if is_admin %}
<li><a href="/admin/user">Admin</a></li>
{% endif %}
<li><a href="#contact">Contact</a></li>
<li><a href="{{logout}}">Logout</a></li>
{% endblock %}
{% block container %}
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-3 col-md-2 sidebar">
          <div class="navbar-example">
              <ul class="nav nav-sidebar">
                <li class="active"><a href="#overview">Overview</a></li>
                {% for network in networks %}
                    <li><a href="#{{network.name|replace(' ', '_')}}">{{network.name}}</a></li>
                {% endfor %}
              </ul>
          </div>
        </div>
        <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
          <h1 class="page-header"><div id="overview">Dashboard</div></h1>
          <div class="row">
            <p>Welcome {{ nick }}.</p>
             <ul>
                <li>{{total_users_machines}} machine(s) contacted in the last 3 minutes.
                <li>{{networks|length}} networks being managed by this user.
              </ul>
            <a href=/u/overview>Edit exec script</a><br>
          </div>
		  {% for network in networks %}
          <h2 class="sub-header"><div id="{{network.name|replace(' ', '_')}}">{{network.name}}</a></h2>
          <div class="table-responsive">
            <table class="table table-striped">
              <thead>
                <tr>
                  <th>IP</th>
                  <th>Last contact</th>
                  <th>Last execution</th>
                </tr>
              </thead>
              <tbody>
                {% for ip, machine in machines.get(network.name).items() %}
                <tr>
                  <td>{{ip}}</td>
                  <td>{{machine.last_datetime}}</td>
                  <td>{{machine.last_output}}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
		  {% endfor %}
        </div>
       </div>
     </div>
{% endblock %}
{% block scripts %}{% endblock %}
